@page "/"
@inject IJSRuntime js

<PageTitle>Maixnor Term</PageTitle>

@* desperately needs replacement *@

<pre>
=================================================
||                                             ||
||       Welcome to the Maixnor Terminal       ||
||                                             ||
||           type help if helpless             ||
||                                             ||
=================================================
</pre>

@foreach (var box in Boxes)
{
    <Block Element="box"/>
}

<Input Parent="this"/>

@code {
    [CascadingParameter] 
    public List<Box> Boxes { get; set; } = new ();

    public record Box(string Command, string Response);

    public void SubmitCommand(string Command)
    {
        if (!Statements.ContainsKey(Command))
        {
            Boxes.Add(new Box(Command, $"The command '{Command}' is not recognized."));
        }
        else
        {
            Statements[Command].Invoke(this); // execute Statements
        }

        StateHasChanged();
    }

    // Statements define changes to the State of the application
    Dictionary<string, Action<Index>> Statements = new()
    {
        {
            "clear",        index => index.Boxes.Clear()
        },
        {
            "exit",         index => index.js.InvokeVoidAsync("window.close")
        },
        {
            "help",         index => index.Boxes.Add(new Box("help", Terminal.Statements.Help))
        },
        {
            "email",        index => index.Boxes.Add(new Box("email", Terminal.Statements.Email))
        },
        {
            "projects",     index => index.Boxes.Add(new Box("projects", Terminal.Statements.Projects))
        },
        {
            "42",           index => index.Boxes.Add(new Box( "42", "the answer to life, the universe, and everything"))
        },
        {
            "github",       index => index.js.InvokeVoidAsync("open", "https://github.com/maixnor", "_blank")
        },
        {
            "linkedin",     index => index.js.InvokeVoidAsync("open", "https://www.linkedin.com/in/benjamin-meixner-a7b82617a/", "_blank")
        },
    };
}

